<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>HTML5 : Géolocalisation</title>
	</head>
	<body>

		<h2>Exercice 2</h2>
		<div id="infoposition"></div>
		<div id="informationposition"></div>
		<h2>Exercice 3</h2>
		<div id="infomouvement"></div>
		<script>
			function maPosition(position) 
			{
				var timestamp = Math.round(new Date().getTime() / 1000);
				var infopos = "Position déterminée :\n";
				infopos += "Latitude : "+position.coords.latitude +"\n";
				infopos += "Longitude: "+position.coords.longitude+"\n";
				infopos += "Altitude : "+position.coords.altitude +"\n";
				infopos += "Vitesse  : "+position.coords.speed +"\n";
				infopos += "TimeStamp  : "+timestamp +"\n";
				document.getElementById("infoposition").innerHTML = infopos;
			}

			if(navigator.geolocation)
				navigator.geolocation.getCurrentPosition(maPosition);
				
			// Fonction de callback en cas de succès
			function surveillePosition(position) 
			{
				var timestamp = Math.round(new Date().getTime() / 1000);
				var infopos = "Position déterminée :\n";
				infopos += "Latitude : "+position.coords.latitude +"\n";
				infopos += "Longitude: "+position.coords.longitude+"\n";
				infopos += "Altitude : "+position.coords.altitude +"\n";
				infopos += "Vitesse  : "+position.coords.speed +"\n";
				infopos += "TimeStamp  : "+timestamp +"\n";
				document.getElementById("informationposition").innerHTML = infopos;
			}

			// On déclare la variable survId afin de pouvoir par la suite annuler le suivi de la position
			var survId = navigator.geolocation.watchPosition(surveillePosition);
			// Annule le suivi de la position si nécessaire.
			//navigator.geolocation.clearWatch(survId);
			
			function handleOrientation(event) 
			{
				var alpha    = event.alpha;
				var beta     = event.beta;
				var gamma    = event.gamma;
				var infomouv = "Position déterminée :\n";
				infomouv += "Absolute : "+ event.absolute +"\n";
				infomouv += "Alpha : "+ event.alpha +"\n";
				infomouv += "Beta : "+ event.beta +"\n";
				infomouv += "Gamma : "+ event.gamma +"\n";
				document.getElementById("infomouvement").innerHTML = infomouv;
			}
			
			if(window.DeviceOrientationEvent)
				window.addEventListener("deviceorientation", handleOrientation, true);
		</script>
	</body>
</html>
